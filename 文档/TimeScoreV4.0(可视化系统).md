# 🎯 TimeScore V4.0 - 可视化系统

## 版本更新概述
本版本针对TimeScore（时间管理计分应用）的可视化系统进行优化，旨在提升“成长可见性”（原有设计哲学），通过多形式反馈强化上瘾循环和用户洞察。核心变化包括：
- 整合评估方案：热力图（强调Streak）、多维时间轴（生产力上下文）、RPG/游戏化反馈（属性成长）、数据洞察/分布图（分配分析）。
- CLI优先实现：使用文本/ASCII艺术，便于命令行原型测试，后续迁移iOS（SwiftUI/Charts支持互动/动画）。
- 个性化视图：默认“极简模式”（仪表盘+时间轴），可选“高级模式”（加RPG/热力图）。
- 核心数据可视化：积分（单次/总）、精力变化、行为等级分布（S/A/B/C/D/R）、心情趋势、连击/Streak、历史对比、时段效率。
- 额外优化：AI生成洞察、混合视图、隐私保护（本地渲染）。

此文档可作为大模型（如LLM）理解和实现的Prompt基础：**"基于以下TimeScore V4.0可视化规格，实现一个命令行时间管理应用的反馈模块。输入用户记录（JSON格式：行为列表含等级、时长、心情、时段、感受）。系统需生成CLI可视化输出，包括仪表盘、时间轴、热力图、分布图和RPG元素。使用Python库如termcolor、texttable、terminalplot。输出格式为文本艺术+总结JSON。iOS迁移提示：用SwiftUI Charts实现互动版本。"**

---

## 一、可视化系统核心规则（V4.0）

### 1. 设计哲学与数据来源
- **哲学**：可视化不止“显示数据”，而是“讲故事”——短期见序列（时间轴）、长期见趋势（热力图）、量化见洞察（分布图）、乐趣见成长（RPG）。符合原有“上瘾循环”（成就动画在iOS实现为动态特效）。
- **数据来源**：用户记录（等级、时长、心情、可选时段/感受）、系统计算（积分、精力、连击、效率比）。历史数据存储在本地DB（CLI用SQLite，iOS用CoreData）。
- **模式开关**：用户设置“极简”（仪表盘+时间轴） vs “高级”（全视图）。默认极简，避免信息过载。
- **隐私**：所有渲染本地，无云端上传。授权整合日历/传感器（e.g., iOS HealthKit推测精力）。

### 2. 核心可视化组件
整合方案，提供多视图切换（CLI用命令，iOS用TabBar）。

#### 2.1 仪表盘概览（KPI卡片，首页默认）
- **描述**：快速卡片显示关键指标，强调即时反馈。
- **可视化元素**：
  - 今日总积分：大数字+进度条（e.g., 560/目标1000）。
  - 能量效率比：圆环（11.3分/点，绿色优秀）。
  - 连击/Streak：徽章+计数（“2连击，正面Streak:3天”）。
  - 心情平均：星级条（★★★☆☆）。
- **CLI实现**：文本框，如：
  ```
  ┌──────────────┐ ┌──────────────┐
  │总积分: 560.5 │ │效率: 11.3/点 │
  └──────────────┘ └──────────────┘
  ```
  用termcolor着色（绿高、红低）。
- **iOS迁移**：SwiftUI Card视图，动画更新（e.g., 积分跳动）。

#### 2.2 热力图/贡献矩阵（强调Streak，如GitHub/Readwise）
- **描述**：月/年网格，颜色深浅代表每日积分强度（<50红、>200深绿）。Streak线标注连续正面天（无C/D级）。
- **额外维度**：边框色示精力剩余（蓝高、灰低）；hover（iOS tap）显示当日总结。
- **CLI实现**：ASCII网格，如：
  ```
  Jan 2026
  S M T W T F S
    1■ 2□ 3■■
  4■■■5■ 6□ 7□
  ```
  用颜色码（ANSI绿/红），标注“Streak:7天”。
- **iOS迁移**：GridView+Gradient，互动zoom，通知“保持Streak！”。
- **优化**：如果数据少，填充“建议：记录更多”。

#### 2.3 多维时间轴（生产力上下文，如RescueTime/Toggl）
- **描述**：横轴一天时间（小时刻度），行为彩条（S绿、R蓝、D红），叠加精力曲线（波形线）和积分标注。心情图标点缀，感受气泡（可选）。
- **额外维度**：时段高亮（黄金黄框），连击箭头连接。
- **CLI实现**：ASCII时间线，如：
  ```
  09:00 [S■■■■■■■■■] 积分:231 精力:-31 心情:★★★★
  12:00 [R■■■■] 积分:9 精力:+6 感受:放松
  14:00 [A■■■■■■] 积分:85 精力:-15
  精力曲线: 100 / 68.5 \ 74.5 / 59.5
  ```
  用progressbar库条形，terminalplot曲线。
- **iOS迁移**：Charts时间序列，pinch缩放，tap详情弹窗。整合日历（会议块）。

#### 2.4 RPG/游戏化反馈（属性成长，如Habitica）
- **描述**：积分转XP，显示属性树（e.g., “专注Lv.4：+10% S级系数”）。Streak解锁装备（“恢复护盾：R级+20%”）。进度条示积累。
- **属性映射**：专注（基于A/S比例）、恢复（R级使用）、耐力（精力平均）。
- **CLI实现**：文本树，如：
  ```
  角色: 时间大师 Lv.3
  XP: [■■■■□□□□] 560/1000
  属性:
  - 专注: Lv.4 (■■■■■)
  - 恢复: Lv.2 (■■)
  装备: 连击剑 (解锁于3连击)
  ```
  用Emoji（🛡️）。
- **iOS迁移**：SpriteKit角色动画，升级火花。链接奖励兑换（e.g., XP换心愿）。

#### 2.5 数据洞察/分布图（分配分析，如Timing）
- **描述**：饼图（等级分布：S30%、A20%、R15%）、柱图（周积分趋势+效率线）。心情柱（星级频次）。
- **额外维度**：叠加历史对比（灰柱上周）。
- **CLI实现**：简单柱，如：
  ```
  等级分布:
  S: ■■■■■ (30%)
  A: ■■■■ (20%)
  周趋势: Mon:###231 Tue:##185 ...
  ```
  用texttable饼模拟（百分比列表）。
- **iOS迁移**：Charts饼/柱，旋转互动，导出PNG。

### 3. AI生成洞察（增强反馈）
- **规则**：基于数据，生成文本总结（e.g., “本周S级+15%，但下午精力低，建议加R级”）。不影响计算，只添价值。
- **CLI**：print在视图下；iOS：Alert弹窗。
- **实现**：用简单规则/嵌入LLM（CLI用本地模型如HuggingFace）。

---

## 二、用户交互与实现细节
- **CLI原型**：Python脚本，输入JSON记录，输出视图（e.g., `python timescore_viz.py --mode=cli --data=records.json`）。用库：termcolor（色）、texttable（表）、terminalplot（图）。
- **iOS迁移**：SwiftUI视图控制器，Charts框架互动。动画：成就时粒子效果。数据同步：CoreData。
- **可选详细记录整合**：时段/感受标注在时间轴（e.g., 气泡文本）。
- **视图切换**：CLI用参数（--view=heatmap）；iOS用段选择器。

---

## 三、实例：程序员小明的一天（V4.0可视化）
### 小明数据：3记录（如V3.0），总分325.7，精力59.5剩，2连击。
### CLI输出示例（简化）：
```
仪表盘:
总积分: 325.7 | 效率: 5.5/点 | Streak:1天 | 心情:★★★

时间轴:
09:00-10:30 [S■■■■■■■■■] 231分 精力↓31 感受:专注但累
12:00-12:30 [R■■■■] 9分 精力↑6 放松
14:00-15:00 [A■■■■■■] 85分 精力↓15

热力图 (Jan 24, 2026):
■■■ (325分，高强度日)

分布图:
等级: S:40% ■■■■ A:30% ■■■ R:20% ■■ D:0%
周积分柱: Fri:###325 (上周:##200)

RPG:
XP:325/500 Lv.2 | 专注:Lv.3 ■■■ | 恢复:Lv.1 ■
洞察: "下午恢复有效，精力回升14%，继续！"
```

**小明反馈**："时间轴让我看到精力波谷，热力图激励不中断，RPG像游戏一样有趣！"

---

## 四、防滥用与平衡（V4.0优化）
- **信息过载保护**：默认只仪表盘+时间轴；高级需启用。
- **性能**：CLI限历史1月；iOS懒加载。
- **新手友好**：首周教程视图（“点击时间轴见详情”）；成就解锁视图。
- **疲劳提示**：低精力视图红框+建议“查看恢复图”。

---