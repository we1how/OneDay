# 🎯 时间管理2.0 (计分版本) - 精力管理系统 V3.0

## 版本更新概述
本版本针对原有精力管理系统进行优化，旨在更贴合真实生活：引入恢复机制、自动被动恢复、简化主观/随机因素，同时保持用户输入极简。核心变化包括：
- 新增“R级”恢复行为，允许精力增加而非仅消耗。
- 细分R级为R1/R2/R3（低/中/高恢复），但用户输入时只需选择“R”作为等级（系统可基于心情/时长智能推测子级，或用户可选指定R1等以最小化负担）。
- 增强自动恢复规则，包括无行为时的被动回复。
- 去除计算中的时段系数、幸运系数和心情系数，以减少主观性和随机性（详见设计说明）。
- 引入可选详细记录字段，提升反思价值而不增加必填负担。

此文档可作为大模型（如LLM）理解和实现的Prompt基础：**"基于以下V3.0规格，实现一个时间管理计分系统的精力模块。用户输入仅限等级（包括新R级）、时长、心情（可选）。系统需智能推测恢复子级、自动计算精力变化，并生成客观得分。输出格式为JSON，包括当前精力、得分和日终统计。"**

---

## 一、精力管理系统核心规则（V3.0）

### 1. 精力基础模型
- **初始精力**：每日起始100点（可基于前日剩余+睡眠推测调整，详见恢复规则）。
- **消耗/恢复逻辑**：原有S/A/B/C/D级行为均为消耗性（固定消耗/分钟）。新增R级为恢复性（负消耗，即增加精力）。
- **精力上限**：120点（防止无限刷恢复）。
- **低精力保护**：精力<30时，正面行为（S/A/B）系数上限0.9；恢复行为（R）加成1.2（鼓励恢复）。设置最低阈值，精力为0时，不得任何积分。
- **必要性说明**：保留精力系统以增加策略深度（e.g., 恢复后高强度），但计算更客观（去除主观/随机系数）。如果用户反馈复杂，可降级为可选模块。

### 2. 行为等级扩展：引入R级
- **R级设计**：专为恢复行为（如散步、冥想、午睡），精力变化为正向（增加）。细分三级以匹配恢复强度，但保持输入极简。
- **用户输入**：等级选项扩展为S/A/B/C/D/R。选择R时，仍只需3输入（等级=R、时长、心情）。系统默认推测子级（详见推测逻辑），或用户可选指定R1/R2/R3（e.g., 输入"R2"作为等级，负担最小）。
- **R级基础表**（每分钟恢复值，积分中性以防刷分）：

| 子级 | 恢复/分钟 | 积分/分钟 | 心理锚点 | 适用行为举例 |
|------|-----------|-----------|---------|-------------|
| **R1** (低恢复) | +0.10点 | 0.2分 | "轻度放松" | 喝茶、听音乐、短暂休息 |
| **R2** (中恢复) | +0.20点 | 0.3分 | "中等恢复" | 散步、瑜伽、阅读休闲书 |
| **R3** (高恢复) | +0.30点 | 0.4分 | "深度恢复" | 午睡、冥想、正念练习 |

**设计原理**：
- 积分低（非零）以奖励记录，但不鼓励“刷R”取代生产性行为。
- 子级细分合理：匹配现实恢复差异（e.g., 午睡>散步）。但不强制用户选子级，保持极简。

### 3. 子级推测逻辑（智能、无需额外输入）
- **基于心情**：心情1-2星→R1（低恢复，承认疲惫）；3星→R2；4-5星→R3（高恢复，强化积极）。
- **基于时长**：时长<15分钟→R1；15-30分钟→R2；>30分钟→R3（假设长时长更深度）。
- **基于上下文**：如果前行为高消耗（S/A），默认R2+（反弹恢复）。系统记录历史，逐渐个性化（e.g., 用户常在午后R3）。
- **覆盖率**：90%场景自动推测，用户仅需R；若需精确，可输入R1等（可选）。

### 4. 自动恢复规则（增强版）
- **间隔恢复**（原有）：行为间隔>30分钟，每分钟恢复0.02点（被动，无需记录）。
- **无行为被动回复**（新）："没做任何事"时（系统检测无记录间隔>1小时），每小时恢复1-2点（基于时间段：早晨/下午高，深夜低）。模拟自然恢复，避免“空闲惩罚”。
- **跨天恢复**（新）：
  - 新一天自动重置到基线：前日剩余 + 睡眠恢复（5-10点/小时，基于授权数据或默认8小时×7点=56点）。
  - 若无睡眠数据，默认+50点（现实锚定：一夜好眠恢复半满）。
- **B级后恢复**（原有优化）：B级行为后，额外恢复其消耗的30%（鼓励维持习惯）。
- **上限与平衡**：被动恢复速率低（防刷），总恢复不超过上限120点。

### 5. 计分公式调整（去除主观/随机因素）
- **核心公式V3.0**：
  ```
  单次得分 = 基础分 × 时长 × 动态系数
  ```
  - **动态系数** = 精力系数 × 专注系数 × 环境系数 × 连击系数（原有6维度中保留客观部分）。
  - **去除**：时段系数（虽基于生物钟，但可视为主观；移到建议模块而非计算）。
  - **去除**：幸运系数（随机性高，易挫败；可用成就系统替换惊喜）。
  - **去除**：心情系数（主观，易操纵；但保留心情记录用于后分析/可视化）。
- **我的意见**：同意你的观点——去除主观（心情）和随机（幸运）能让系统更可靠、公平，用户更信任计算（e.g., 避免“今天心情差就低分”的挫败）。时段系数稍有争议：它基于科学（circadian rhythm），不算纯主观，可作为可选开关（默认关）。心情记录保留好：不影响得分，但用于日终报告（如“平均心情3星，建议优化”），或可视化（心情趋势图）。整体，这让系统更“科学化”，但若用户想惊喜，可加非计算的“随机提示”（e.g., 每日励志语）。

- **精力变化公式**（统一）：
  ```
  当前精力 = 上次精力 - 消耗（或+恢复） + 自动恢复
  ```
  - 对于R级：消耗为负值（恢复）。
  - 精力系数仍基于当前精力（原有公式），影响动态系数。

---

## 二、用户输入与记录扩展
- **核心输入**：保持极简——等级（S/A/B/C/D/R，或R1等）、时长（分钟）、心情（1-5星，可选默认3）。
- **可选详细记录**（新，不必填）：
  - **具体时段**：文本输入，如“上午9:00-10:00”（系统可解析时间戳，用于时段分析/可视化，但不影响计算）。
  - **当时的感受**：简短文本，如“感觉放松但分心”（用于个人反思、日志，或AI总结，如“本周恢复行为感受积极率80%”）。
- **输入负担**：可选字段在App中隐藏，默认不显示；用户启用后才出现。系统可从心情推测感受（e.g., 低星→“疲惫”）。
- **好处**：提升“成长可见性”（原有），如可视化时间轴上标注感受。合理性高：不违背极简，但为高级用户加深度。

---

## 三、实例：程序员小明的一天（V3.0精力焦点）
### 小明输入（含R级）：
1. 上午9:00-10:30 | S级 | 90分钟 | ★★★★☆ | 感受："专注但累"
2. 中午12:00-12:30 | R级 | 30分钟 | ★★★☆☆ | 感受："小憩恢复"
3. 下午14:00-15:00 | A级 | 60分钟 | ★★★☆☆

### 系统计算（去除系数后简化）：
- **初始精力**：100点。
#### 记录1：S级
- 基础分：1.8×90=162
- 动态系数：精力1.3（高）、专注1.1、环境1.0、连击1.0 → 总1.3×1.1×1.0×1.0=1.43
- 得分：162×1.43=231.7分
- 消耗：90×0.35=31.5点 → 剩余68.5点

#### 记录2：R级（推测R2，中恢复）
- 基础分：0.3×30=9（低积分）
- 动态系数：精力0.985（中）、等 → 总≈1.0
- 得分：9×1.0=9分
- 恢复：30×0.20=6点 → 剩余74.5点（间隔恢复+0.5点）

#### 记录3：A级
- 类似计算，得分≈85分，消耗15点 → 剩余59.5点
- 日终：总分325.7，精力效率5.5分/点（客观计算）。

**小明反馈**："R级让我记录休息而不愧疚，精力回升后下午更高效！"

---

## 四、防滥用与平衡（V3.0优化）
- **防刷R**：连续R级>2次，恢复率递减20%；单日R积分上限50分。
- **疲劳保护**：精力<20时，强制建议R级（弹窗）。

---
